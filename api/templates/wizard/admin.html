<div class="card" x-data="{ key: '' }">
  <h2 class="text-base mb-3">Admin API Key</h2>
  <p class="text-muted text-sm mb-3">Set a key to protect the admin API. You'll need this to access the dashboard after setup.</p>

  <label class="label" for="w-admin-key">API Key</label>
  <input type="password" class="input" id="w-admin-key" name="admin_key" x-model="key">

  <div class="mt-3">
    <button class="btn" @click="
      const arr = new Uint8Array(24);
      crypto.getRandomValues(arr);
      key = Array.from(arr, b => b.toString(16).padStart(2, '0')).join('');
    ">Generate random key</button>
  </div>

  <div class="flex justify-between mt-4">
    <button class="btn"
            hx-post="/setup/step" hx-target="#wizard-step" hx-swap="innerHTML"
            hx-vals='{"step": "search", "values": {}}'>
      Back
    </button>
    <button class="btn-primary"
            @click="
              localStorage.setItem('admin_api_key', key);
              htmx.ajax('POST', '/setup/step', {
                target: '#wizard-step', swap: 'innerHTML',
                values: {
                  step: 'done',
                  'values[admin.api_key]': key,
                  'values[admin.enabled]': 'true'
                }
              })
            ">
      Next
    </button>
  </div>
</div>
